1: What's the most expensive listing? What else can you tell me about the listing?

- There are three listings that are equally 'most' expensive. Each of these have a price of $10,000. Two of these listings
market themselves as close to Downtown Austin. One of them says that a personal chef and driver is available. Of these three,
the most recent host has been hosting since March, 2016 and the longest host started in October, 2014. One host says that they
have designed their location to be like a cathedral, a place of, "refuge, beauty, and joy."

WITH maximum AS (
	SELECT 
		MAX(CAST(SUBSTR(REPLACE(price, ',', ''),2)AS DECIMAL)) AS max_price
	FROM 
		listings
)

SELECT 
	*
FROM 
	listings,
	maximum
WHERE 
	(CAST(SUBSTR(REPLACE(price, ',', ''),2)AS DECIMAL)) = maximum.max_price
	
2: What neighborhoods seem to be the most popular?

select
	neighbourhood,
	count(*)
from
	listings
group by 1
order by 2 desc

3: What time of year is the cheapest time to go to your city? 

UPDATE calendar
SET price= REPLACE(price,'$',' ');
UPDATE calendar
SET price= REPLACE(price,',','');
UPDATE calendar
SET price= REPLACE(price,' ','');

select
	date,
	AVG(price)
from
	calendar
group by 1
order by 2

-- What about the busiest?

select
	date,
	available,
	count(*) AS not_available
from
	calendar
where 
	available = 'f'
group by 1
order by 3 desc


select
	listing_id,
	available,
	count(*) AS not_available
from
	calendar
where 
	available = 'f'
group by 1
order by 3
